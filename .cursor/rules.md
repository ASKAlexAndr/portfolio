# Правила для AI-агентов (Cursor / Copilot / и т.п.)

- Назначение: единый свод правил редактирования кода AI-агентами в этом репозитории.
- Обязательны к соблюдению для любых автоматизированных правок.

## Нельзя изменять

- Любые строки или блоки кода, помеченные маркером важности:
  - `// IMPORTANT` — запрещено менять, удалять, переносить или форматировать эти строки.
  - `/* IMPORTANT */` — запрещено менять содержимое в пределах такого комментария.
- Если требуется изменение «важного» кода, сначала создайте отдельный PR/issue с пояснением причин и ожидаемым эффектом.

## Разрешено

- Внесение правок вокруг «важных» фрагментов без изменения самих «важных» строк/блоков.
- Нефункциональное форматирование за пределами «важных» строк (переносы строк, пробелы вне важного участка).

## Как помечать защищённые области

- Для одиночных строк: добавьте `// IMPORTANT` в конце строки.
- Для блоков:
  - Начало: `// IMPORTANT START`
  - Конец: `// IMPORTANT END`
  - Всё между этими комментариями считается неизменяемым.

## Исключения (точечно)

- Если изменение необходимо и санкционировано, добавьте рядом временный маркер-разрешение:
  - `// AI:ALLOW_MODIFY` — только для конкретной строки/следующего блока.
  - После внесения правок маркер должен быть удалён ревьювером.

## Общие рекомендации для AI-правок

- Никогда не удаляйте и не изменяйте комментарии с требованиями/предупреждениями.
- Не рефакторьте публичные API без явного запроса/задачи.
- Соблюдайте существующий стиль кода и форматирование.
- При сомнениях — предложите изменения в тексте PR/коммита, а не применяйте их автоматически.

## Практики, сформированные сообществом

- Общие ограничения
  - Не изменять код, помеченный как важный (`// IMPORTANT`, `// IMPORTANT START/END`).
  - Не править автогенерируемые файлы и артефакты: `node_modules/`, `.next/`, `build/`, `dist/`, lock-файлы, сгенерированные типы/SDK.
  - Не вносить ломающие изменения в публичные API без явной задачи/миграционного плана.

- Объём и область правок
  - Делать минимально необходимые правки, без скрытого рефакторинга.
  - Крупные изменения дробить на логические PR.
  - Не перемещать файлы/не переименовывать модули без причины и отдельной задачи.

- Стиль, линтер, форматирование
  - Следовать ESLint/Prettier/Tailwind правилам проекта.
  - Не отключать линтер глобально; если нужно — только точечно и с комментарием.
  - Сохранять строгую типизацию (TypeScript), избегать `any` без необходимости.

- Тесты и сборка
  - Любая функциональная правка требует зелёной сборки и тестов.
  - Для изменений поведения — добавлять/обновлять тесты.
  - Не снижать покрытие тестами без согласования.

- Безопасность и секреты
  - Не добавлять секреты/ключи в код. Пользоваться переменными окружения.
  - Проверять лицензии/вес новых зависимостей.

- Зависимости
  - Обновлять по semver; фиксировать версии согласно политике проекта.
  - Не править package.json/lock вручную — только через `install`/CI.

- Документация и комментарии
  - Не удалять важные комментарии и докблоки.
  - Обновлять README/миграционные заметки при изменении сценариев.

- Git и PR-практики
  - Коммиты по Conventional Commits: `feat:`, `fix:`, `chore:`, `refactor:`, `docs:` …
  - PR с мотивацией, рисками, планом отката и ссылкой на issue.
  - Не смешивать функциональные изменения и форматирование.

- Next.js/React-специфика
  - Клиентские хуки использовать только в компонентах с `"use client"`.
  - Не использовать `i18n` из `next.config` с App Router; применять провайдер/роутинг.
  - `viewport` — через export `viewport`; шрифты с `display: swap`, `preconnect`.
  - Использовать `next/image`, ленивую загрузку, избегать тяжёлых анимаций вне вьюпорта.

- i18n
  - Не хардкодить строки — использовать `t()`; поддерживать синхронность `en/ru` JSON.
  - Не менять ключи без обновления переводов; не вкладывать лишний HTML в переводы.

- Доступность и UX
  - Сохранять aria-атрибуты/role, фокус-стили и навигацию с клавиатуры.
  - Кнопки/таргеты — не менее 44px на тач-устройствах.

- Производительность
  - Анимации — через transform/opacity, учитывать `prefers-reduced-motion`.
  - Динамический импорт секций ниже фолда.
